document.addEventListener("DOMContentLoaded",(function(){var messagesContainer=document.getElementById("messages");var fileInput=document.getElementById("fileInput");var userInput=document.getElementById("userInput");var sendMessageButton=document.getElementById("sendMessage");var clearMessagesButton=document.getElementById("clearMessages");var clearPDFInfoButton=document.getElementById("clearPDFInfo");var pdfFileNameElement=document.getElementById("pdfFileName");var fileInputLabel=document.getElementById("fileInputLabel");var apiUrl="http://localhost:5000";fileInputLabel.addEventListener("click",(function(){fileInput.click()}));fileInput.addEventListener("change",(function(event){var file=fileInput.files[0];if(file){showLoadingAnimation();var formData=new FormData;formData.append("pdf",file);fetch("".concat(apiUrl,"/upload-pdf"),{method:"POST",body:formData}).then((function(response){return response.json()})).then((function(data){var fileName=data.filename;pdfFileNameElement.innerText=" ".concat(fileName);hideLoadingAnimation()})).catch((function(error){console.error("Fetch error:",error);hideLoadingAnimation()}))}else{sendMessageButton.disabled=true;pdfFileNameElement.innerText=""}}));function showLoadingAnimation(){var loadingElement=document.createElement("div");loadingElement.textContent="Loading...";loadingElement.classList.add("loading-animation");document.body.appendChild(loadingElement)}function hideLoadingAnimation(){var loadingElement=document.querySelector(".loading-animation");if(loadingElement){loadingElement.remove()}}sendMessageButton.addEventListener("click",(function(){var userMessage=userInput.value;if(userMessage===null||userMessage.trim()===""){console.log("alert");return}if(fileInput.files.length===0){alert("PDFファイルを選んでください");return}displayMessage(userMessage,"user");showLoadingAnimation();fetch("".concat(apiUrl,"/generate-response"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_message:userMessage})}).then((function(response){return response.json()})).then((function(data){var botResponse=data.response;hideLoadingAnimation();displayMessage(botResponse,"bot")})).catch((function(error){console.error("Fetch error:",error);hideLoadingAnimation()}));userInput.value=""}));clearMessagesButton.addEventListener("click",(function(event){addRippleEffect(event);messagesContainer.innerHTML="";fetch("".concat(apiUrl,"/clear-messages"),{method:"POST"})}));clearPDFInfoButton.addEventListener("click",(function(event){addRippleEffect(event);fileInput.value="";pdfFileNameElement.innerText="";fetch("".concat(apiUrl,"/clear-pdf-info"),{method:"POST"});messagesContainer.innerHTML="";fetch("".concat(apiUrl,"/clear-messages"),{method:"POST"})}));function handleInputKeyDown(event){if(event.key==="Enter"&&!event.shiftKey){event.preventDefault();sendMessageButton.click()}}userInput.addEventListener("keydown",handleInputKeyDown);function displayMessage(message,sender){var messageDiv=document.createElement("div");messageDiv.classList.add("message",sender);messageDiv.innerText=message;messagesContainer.appendChild(messageDiv)}function addRippleEffect(event){var button=event.target;var ripple=document.createElement("span");var rect=button.getBoundingClientRect();var size=Math.max(rect.width,rect.height);var x=event.clientX-rect.left-size/2;var y=event.clientY-rect.top-size/2;ripple.style.width=ripple.style.height="".concat(size,"px");ripple.style.left="".concat(x,"px");ripple.style.top="".concat(y,"px");ripple.classList.add("ripple");var existingRipple=button.getElementsByClassName("ripple");if(existingRipple.length>0){button.removeChild(existingRipple[0])}button.appendChild(ripple);ripple.addEventListener("animationend",(function(){ripple.remove()}))}}));